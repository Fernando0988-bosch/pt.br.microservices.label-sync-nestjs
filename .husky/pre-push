#!/usr/bin/env sh

# Verificar se há commits anteriores e origin/main existe
if git rev-parse --verify origin/main >/dev/null 2>&1; then
  # origin/main existe, executar affected test
  npx nx affected:test --coverage --base=origin/main --head=HEAD
else
  # origin/main não existe, executar todos os testes
  echo "⏭️ origin/main não encontrado, executando todos os testes..."
  npx nx run-many --target=test --all --coverage
fi
